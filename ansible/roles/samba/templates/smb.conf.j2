[global]
   workgroup = WORKGROUP
   server string = Storage Server
   server role = standalone server
   
   # Logging
   log file = /var/log/samba/log.%m
   max log size = 1000
   logging = file
   
   # Security
   security = user
   map to guest = never
   
   # Performance
   socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=131072 SO_SNDBUF=131072
   read raw = yes
   write raw = yes
   use sendfile = yes
   aio read size = 16384
   aio write size = 16384
   
   # Apple/macOS compatibility
   vfs objects = fruit streams_xattr
   fruit:metadata = stream
   fruit:model = MacSamba
   fruit:posix_rename = yes
   fruit:veto_appledouble = no
   fruit:wipe_intentionally_left_blank_rfork = yes
   fruit:delete_empty_adfiles = yes

[media]
   path = {{ storage_base_path }}/media
   browseable = yes
   read only = no
   guest ok = no
   valid users = {{ smb_users | map(attribute='name') | join(', ') }}
   create mask = 0664
   directory mask = 0775
   force user = nobody
   force group = nogroup

[downloads]
   path = {{ storage_base_path }}/downloads
   browseable = yes
   read only = no
   guest ok = no
   valid users = {{ smb_users | map(attribute='name') | join(', ') }}
   create mask = 0664
   directory mask = 0775
   force user = nobody
   force group = nogroup

[backups]
   path = {{ storage_base_path }}/backups
   browseable = yes
   read only = no
   guest ok = no
   valid users = {{ smb_users | map(attribute='name') | join(', ') }}
   create mask = 0664
   directory mask = 0775
   force user = nobody
   force group = nogroup
